<Window x:Class="AdvancedWPFGrid.Export.UI.ExportSettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AdvancedWPFGrid.Export.UI"
        mc:Ignorable="d"
        Title="Export Settings" Height="450" Width="400"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False"
        ResizeMode="NoResize"
        Background="{DynamicResource FluentSurfaceBrush}"
        TextElement.Foreground="{DynamicResource FluentTextPrimaryBrush}">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Export Columns" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
        
        <Border Grid.Row="1" BorderBrush="{DynamicResource FluentBorderBrush}" BorderThickness="1" CornerRadius="4">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <CheckBox Content="Select All" 
                          IsChecked="{Binding AllColumnsSelected}" 
                          Command="{Binding ToggleAllCommand}"
                          Margin="10,8" FontWeight="SemiBold"/>
                
                <ListBox Grid.Row="1" ItemsSource="{Binding Columns}" BorderThickness="0" Background="Transparent">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <CheckBox IsChecked="{Binding IsSelected}" Content="{Binding Header}" Margin="5,2"/>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Border>

        <StackPanel Grid.Row="2" Margin="0,15,0,0">
            <TextBlock Text="Options" FontWeight="Bold" Margin="0,0,0,5"/>
            <CheckBox Content="Include Headers" IsChecked="{Binding Options.IncludeHeaders}" Margin="0,4"/>
            <CheckBox Content="Export Filtered Data Only" IsChecked="{Binding Options.VisibleRowsOnly}" Margin="0,4"/>
            <CheckBox Content="Include Summary Row" IsChecked="{Binding Options.IncludeSummary}" Margin="0,4"/>
            <CheckBox Content="Open File After Export" IsChecked="{Binding Options.OpenAfterExport}" Margin="0,4"/>
        </StackPanel>

        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button Content="Export" Width="80" Height="28" 
                    Command="{Binding OkCommand}" 
                    Background="{DynamicResource FluentAccentBrush}" 
                    Foreground="White" BorderThickness="0" Margin="0,0,10,0"/>
            <Button Content="Cancel" Width="80" Height="28" 
                    Command="{Binding CancelCommand}"
                    Background="Transparent" BorderBrush="{DynamicResource FluentBorderBrush}"/>
        </StackPanel>
    </Grid>
</Window>
