<Window x:Class="EasyUse.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:EasyUse"
        xmlns:av="clr-namespace:AdvancedWPFGrid.Controls;assembly=AdvancedWPFGrid"
        xmlns:col="clr-namespace:AdvancedWPFGrid.Columns;assembly=AdvancedWPFGrid"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:Data="clr-namespace:AdvancedWPFGrid.Data;assembly=AdvancedWPFGrid"
        mc:Ignorable="d"
        Title="Easy Use - Advanced WPF Grid Demo" Height="800" Width="1200"
        Icon="Assets/app_icon.png"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="White"
        x:Name="RootWindow">
    
    <Window.Resources>
        <local:BindingProxy x:Key="Proxy" Data="{Binding}"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Easy Use Demo" FontSize="20" FontWeight="Bold" Margin="10"/>

        <TabControl Grid.Row="1" Margin="10">
            <!-- Settings Tab -->
            <TabItem Header="Settings">
                <StackPanel Margin="20">
                    <TextBlock Text="Decimal Places:" FontWeight="SemiBold" Margin="0,0,0,5"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <TextBlock Text="{Binding DecimalPlaces}" 
                                   Width="50" FontSize="16" VerticalAlignment="Center" 
                                   TextAlignment="Center" FontWeight="Bold"
                                   Background="#DDDDDD" Padding="5"/>
                        
                        <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                            <Button Content="▲" Command="{Binding IncrementDecimalsCommand}" Width="30" Height="15" FontSize="8"/>
                            <Button Content="▼" Command="{Binding DecrementDecimalsCommand}" Width="30" Height="15" FontSize="8"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <TextBlock Text="Grouping:" FontWeight="SemiBold" Margin="0,10,0,5"/>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <TextBlock Text="1: " VerticalAlignment="Center" Width="20"/>
                        <ComboBox ItemsSource="{Binding AvailableColumns}" SelectedItem="{Binding SelectedGroup1}" Width="120" Margin="0,0,10,0"/>
                        
                        <TextBlock Text="2: " VerticalAlignment="Center" Width="20"/>
                        <ComboBox ItemsSource="{Binding AvailableColumns}" SelectedItem="{Binding SelectedGroup2}" Width="120" Margin="0,0,10,0"/>
                        
                        <TextBlock Text="3: " VerticalAlignment="Center" Width="20"/>
                        <ComboBox ItemsSource="{Binding AvailableColumns}" SelectedItem="{Binding SelectedGroup3}" Width="120"/>
                    </StackPanel>
                    <TextBlock Text="Select columns to group by. Order matters." FontStyle="Italic" Foreground="Gray" FontSize="10"/>

                    <TextBlock Text="Appearance:" FontWeight="SemiBold" Margin="0,20,0,5"/>
                    <CheckBox Content="Show Vertical Grid Lines" IsChecked="{Binding HasVerticalGridLines}" Margin="0,0,0,5"/>
                    <CheckBox Content="Show Horizontal Grid Lines" IsChecked="{Binding HasHorizontalGridLines}" Margin="0,0,0,5"/>
                    <CheckBox Content="Enable Alternating Row Colors" IsChecked="{Binding AlternatingRows}" Margin="0,0,0,10"/>
                    <CheckBox Content="Show Summary Row" IsChecked="{Binding ShowSummaryRow}" Margin="0,0,0,5"/>
                    <CheckBox Content="Allow Export" IsChecked="{Binding CanUserExport}" Margin="0,0,0,5"/>
                    <CheckBox Content="Header Vertical Lines" IsChecked="{Binding HasVerticalHeaderSeparator}" Margin="0,0,0,5"/>
                    <CheckBox Content="Summary Vertical Lines" IsChecked="{Binding HasVerticalSummarySeparator}" Margin="0,0,0,5"/>
                    <CheckBox Content="Frozen Column Separation" IsChecked="{Binding HasVerticalFrozenColumnSeparator}" Margin="0,0,0,5"/>
                    
                    <TextBlock Text="Summary Alignment:" FontWeight="SemiBold" Margin="0,10,0,5"/>
                    <ComboBox SelectedItem="{Binding SummaryAlignment}" Margin="0,0,0,10" Width="150" HorizontalAlignment="Left">
                        <ComboBox.Items>
                            <HorizontalAlignment>Left</HorizontalAlignment>
                            <HorizontalAlignment>Center</HorizontalAlignment>
                            <HorizontalAlignment>Right</HorizontalAlignment>
                        </ComboBox.Items>
                    </ComboBox>

                    <TextBlock Text="Features" FontWeight="SemiBold" Margin="0,16,0,8"/>
                <CheckBox Content="Allow Sorting" IsChecked="{Binding CanUserSort}"/>
                <CheckBox Content="Allow Filtering" IsChecked="{Binding CanUserFilter}" Margin="0,4,0,0"/>
                <CheckBox Content="Allow Reorder" IsChecked="{Binding CanUserReorderColumns}" Margin="0,4,0,0"/>
                <CheckBox Content="Allow Resize" IsChecked="{Binding CanUserResizeColumns}" Margin="0,4,0,0"/>

                <Separator Margin="0,16"/>

                <TextBlock Text="Search Panel" FontWeight="SemiBold" Margin="0,0,0,8"/>
                <CheckBox Content="Show Search Panel" IsChecked="{Binding IsSearchPanelVisible}"/>
                <CheckBox Content="Auto Search" IsChecked="{Binding IsAutoSearchEnabled}" Margin="0,4,0,0"/>
                
                <Grid Margin="0,8,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Delay (s):" VerticalAlignment="Center"/>
                    <TextBox Text="{Binding SearchDelaySeconds, StringFormat=N1}" Margin="8,0,0,0" Grid.Column="1"/>
                </Grid>

                <Grid Margin="0,8,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Count Mode:" VerticalAlignment="Center"/>
                     <ComboBox SelectedItem="{Binding SearchCountMode}" 
                               ItemsSource="{Binding SearchCountModes}"
                               Margin="8,0,0,0" Grid.Column="1"/>
                </Grid>

                <TextBlock Text="Frozen Columns:" FontWeight="SemiBold" Margin="0,16,0,5"/>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                    <TextBlock Text="{Binding FrozenColumnCount}" 
                               Width="50" FontSize="16" VerticalAlignment="Center" 
                               TextAlignment="Center" FontWeight="Bold"
                               Background="#DDDDDD" Padding="5"/>

                    <StackPanel Orientation="Vertical" Margin="5,0,0,0">
                        <Button Content="▲" Command="{Binding IncrementFrozenColumnsCommand}" Width="30" Height="15" FontSize="8"/>
                        <Button Content="▼" Command="{Binding DecrementFrozenColumnsCommand}" Width="30" Height="15" FontSize="8"/>
                    </StackPanel>
                </StackPanel>

                </StackPanel>
            </TabItem>

            <!-- Data Grid Tab -->
            <TabItem Header="Data Grid">
                <av:AdvancedGrid ItemsSource="{Binding People}"
                                 HasVerticalGridLines="{Binding HasVerticalGridLines}"
                                 HasHorizontalGridLines="{Binding HasHorizontalGridLines}"
                                 AlternatingRows="{Binding AlternatingRows}"
                                 CanUserSort="{Binding CanUserSort}"
                                 CanUserFilter="{Binding CanUserFilter}"
                                 CanUserReorderColumns="{Binding CanUserReorderColumns}"
                                 CanUserResizeColumns="{Binding CanUserResizeColumns}"
                                 DoubleFormat="{Binding GlobalDoubleFormat}"
                                 GroupDescriptions="{Binding GroupDescriptors}"
                                 IsSearchPanelVisible="{Binding IsSearchPanelVisible}"
                                 IsAutoSearchEnabled="{Binding IsAutoSearchEnabled}"
                                 SearchDelay="{Binding SearchDelay}"
                                 SearchCountMode="{Binding SearchCountMode}"
                                 ShowSummaryRow="{Binding ShowSummaryRow}"
                                 CanUserExport="{Binding CanUserExport}"
                                 SummaryAlignment="{Binding SummaryAlignment}"
                                 FrozenColumnCount="{Binding FrozenColumnCount}"
                                 HasVerticalHeaderColumnSeparator="{Binding HasVerticalHeaderSeparator}"
                                 HasVerticalSummarySeparator="{Binding HasVerticalSummarySeparator}"
                                 HasVerticalFrozenColumnSeparator="{Binding HasVerticalFrozenColumnSeparator}"
                                 x:Name="MainGrid">
                    <av:AdvancedGrid.AggregateFunctions>
                        <Data:AggregateFunction PropertyName="Name" FunctionType="Count" Caption="Total" />
                        <Data:AggregateFunction PropertyName="PerformanceScore" FunctionType="Average" StringFormat="Avg: {0:N1}" />
                        <Data:AggregateFunction PropertyName="Salary" FunctionType="Sum" Caption="Total" />
                        <Data:AggregateFunction PropertyName="Salary" FunctionType="Average" StringFormat="Avg: {0:C0}" />
                        <Data:AggregateFunction PropertyName="Bonus" FunctionType="Sum" Caption="Total Bonus" />
                    </av:AdvancedGrid.AggregateFunctions>
                    <av:AdvancedGrid.Columns>
                        <!-- Selection Column -->
                        <col:SelectionColumn Width="50" />
                        
                        <!-- Text Column -->
                        <col:TextColumn Header="Name" 
                                        Binding="Name" 
                                        HeaderToolTip="Full name of the person"
                                        Width="150"/>

                        <!-- Text Column -->
                        <col:TextColumn Header="Department" 
                                        Binding="Department" 
                                        Width="120"/>

                        <!-- Text Column -->
                        <col:TextColumn Header="Country" 
                                        Binding="Country" 
                                        Width="100"/>

                        <!-- Text Column -->
                        <col:TextColumn Header="Email" 
                                        Binding="Email" 
                                        Width="200"/>

                        <!-- Double Column -->
                        <col:DoubleColumn Header="Age" 
                                          Binding="Age" 
                                          HeaderToolTip="Current age in years"
                                          Width="60"/>

                        <!-- Double Column -->
                        <col:DoubleColumn Header="Experience" 
                                          Binding="ExperienceYears" 
                                          Width="80"/>

                        <!-- Double Column -->
                        <col:DoubleColumn Header="Projects" 
                                          Binding="ProjectCount" 
                                          Width="80"/>

                        <!-- New Performance Score Column (Uses Global Format) -->
                        <col:DoubleColumn Header="Performance" 
                                          Binding="PerformanceScore" 
                                          Width="100"/>
                                          
                        <!-- Double Column with Currency -->
                        <col:DoubleColumn Header="Salary" 
                                          Binding="Salary" 
                                          HeaderToolTip="Annual base salary in USD"
                                          Width="100"/>

                        <!-- Double Column -->
                        <col:DoubleColumn Header="Bonus" 
                                          Binding="Bonus" 
                                          Width="100"/>

                        <!-- Double Column -->
                        <col:DoubleColumn Header="Rating" 
                                          Binding="Rating" 
                                          Width="80"/>

                        <!-- CheckBox Column -->
                        <col:CheckBoxColumn Header="Active" 
                                            Binding="IsActive" 
                                            Width="60"/>

                        <!-- CheckBox Column -->
                        <col:CheckBoxColumn Header="Remote" 
                                            Binding="IsRemote" 
                                            Width="60"/>

                        <!-- ComboBox Column -->
                        <col:ComboBoxColumn Header="Role" 
                                            Binding="Role" 
                                            ItemsSource="{Binding Data.Roles, Source={StaticResource Proxy}}"
                                            Width="120"/>

                        <!-- Button Column -->
                        <col:ButtonColumn Header="Bio" 
                                          ButtonContent="View"
                                           Command="{Binding Data.ShowBioCommand, Source={StaticResource Proxy}}"
                                          Width="80"
                                          CanSort="False"
                                          CanFilter="False"/>

                        <!-- Icon Button Column (Edit) -->
                        <col:IconButtonColumn Header="Edit"
                                              IconData="{x:Static col:IconButtonColumn.EditIcon}"
                                               Command="{Binding Data.EditCommand, Source={StaticResource Proxy}}"
                                              ToolTipText="Edit user"
                                              Width="50"
                                              CanSort="False" 
                                              CanFilter="False"/>

                        <!-- Icon Button Column (Delete) -->
                        <col:IconButtonColumn Header="Delete"
                                              IconData="{x:Static col:IconButtonColumn.DeleteIcon}"
                                               Command="{Binding Data.DeleteCommand, Source={StaticResource Proxy}}"
                                              ToolTipText="Delete user"
                                              Width="50"
                                              CanSort="False" 
                                              CanFilter="False"/>


                        <!-- Text Button Column -->
                        <col:TextButtonColumn Header="Status"
                                              Binding="Name"
                                              ButtonContent="Approve"
                                                Command="{Binding Data.ApproveCommand, Source={StaticResource Proxy}}"
                                              ButtonPosition="Right"
                                              ButtonWidth="70"
                                              Width="180"
                                              ShowSummary="False"
                                              CanSort="False"
                                              CanFilter="False"/>
                                              
                    </av:AdvancedGrid.Columns>
                </av:AdvancedGrid>
            </TabItem>
        </TabControl>
    </Grid>
</Window>
